<!DOCTYPE html>
<html>
<head>
    <title>Test Debug Response</title>
</head>
<body>
    <h1>Test Debug Response</h1>
    <button onclick="testOne()">Test Statistiche Raw</button>
    <pre id="result"></pre>

    <script>
    async function testOne() {
        try {
            const response = await fetch('API/ConsuntivazioneAPI.php', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ action: 'get_statistiche' })
            });
            
            const text = await response.text();
            console.log('Raw response:', text);
            
            // Verifica se ci sono due JSON
            const jsonStrings = text.match(/\{[^}]*\}/g);
            
            document.getElementById('result').textContent = 
                'Status: ' + response.status + 
                '\nContent-Type: ' + response.headers.get('Content-Type') +
                '\nRaw Response Length: ' + text.length +
                '\nJSON Objects Found: ' + (jsonStrings ? jsonStrings.length : 0) +
                '\nFull Response:\n' + text;
                
        } catch (error) {
            document.getElementById('result').textContent = 'Error: ' + error.message;
        }
    }
    </script>
</body>
</html>